<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js coal">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Code Colosseum</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "coal";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('coal')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="coco.html"><strong aria-hidden="true">1.</strong> Code Colosseum</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="coco/arch.html"><strong aria-hidden="true">1.1.</strong> Architecture</a></li><li class="chapter-item expanded "><a href="coco/lobby.html"><strong aria-hidden="true">1.2.</strong> Lobby</a></li></ol></li><li class="chapter-item expanded "><a href="cli.html"><strong aria-hidden="true">2.</strong> Command Line Client</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="cli/list.html"><strong aria-hidden="true">2.1.</strong> list</a></li><li class="chapter-item expanded "><a href="cli/lobby.html"><strong aria-hidden="true">2.2.</strong> lobby</a></li><li class="chapter-item expanded "><a href="cli/new.html"><strong aria-hidden="true">2.3.</strong> new</a></li><li class="chapter-item expanded "><a href="cli/connect.html"><strong aria-hidden="true">2.4.</strong> connect</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="cli/stdio.html"><strong aria-hidden="true">2.4.1.</strong> stdio</a></li><li class="chapter-item expanded "><a href="cli/pipe.html"><strong aria-hidden="true">2.4.2.</strong> pipe</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="games.html"><strong aria-hidden="true">3.</strong> Games</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="games/roshambo.html"><strong aria-hidden="true">3.1.</strong> roshambo</a></li><li class="chapter-item expanded "><a href="games/royalur.html"><strong aria-hidden="true">3.2.</strong> royalur</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Server Setup</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Writing a Game</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Network Protocol</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Code Colosseum</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/dariost/CodeColosseum" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="code-colosseum"><a class="header" href="#code-colosseum">Code Colosseum</a></h1>
<p><strong>Code Colosseum</strong> is a platform to create and play algorithmic multiplayer games.
Its main purposes are to provide an easier way to create multiplayer games that can
be played by programs, and to provide the necessary tooling to assist the creation
and interconnection of such programs.</p>
<p>This documentation serves as the primary source to understand how <strong>Code Colosseum</strong>
works, how to use it (be it on the client side or on the server side), and how to
create programs to play its games. It also provides the descriptions of currently
supported games.</p>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p><strong>Code Colosseum</strong> is free software. It's released under the
<a href="https://www.mozilla.org/MPL/2.0/">Mozilla Public License v2.0</a>.</p>
<h1 id="architecture"><a class="header" href="#architecture">Architecture</a></h1>
<p><strong>Code Colosseum</strong> has a peculiar architecture when compared with software with
similar purposes (e.g. contest management systems): <em>all user programs run on the</em>
<em>user's machine</em>. This is not <em>that</em> unusual, in fact some competitions, such as
the <a href="https://www.facebook.com/codingcompetitions/hacker-cup">Facebook Hacker Cup</a>,
already evaluate all contestants code on the contestant's machine. However, these
competitions all share a common trait: there is no interaction between the user's
code and the remote evaluation program but the initial input download and the final
output upload. Such systems are unable to deal with interactive problems.</p>
<p><strong>Code Colosseum</strong> provides a system that has both the ability to deal with the
interaction between the user's code and the remote evaluator and executes the user's
code on the user's machine. To achieve that, it creates a virtual connection between
the user's program and the remote evaluator, such that, in its simplest form, the
user's program <em>standard output</em> is redirected into the <em>standard input</em> of the
remote evaluator, and <em>vice versa</em>.</p>
<p>Note that, unlike more traditionals contest management systems, <strong>Code Colosseum</strong>'s
primary purpose is to deal with multiplayer games, as such the concept of the more
traditional evaluator is substituted with the concept of game manager, which is a
program that manages an instance of a game, collects inputs from \( n \) clients,
computes the game simulation accordingly, and sends back the updates.</p>
<h1 id="lobby"><a class="header" href="#lobby">Lobby</a></h1>
<p><strong>Code Colosseum</strong> provides no user authentication by design. The rationale is
to keep its codebase and its setup as simple as possible. This, however, comes
at the cost of having a (bit) more complicated match setup.</p>
<p><strong>Code Colosseum</strong> keeps a lobby of waiting to start and running matches. The lobby
serves as the sole access point for players to join a match waiting to start.</p>
<p>The command line client provides a way to show the current status of the lobby.
Other clients could provide it as well.</p>
<h2 id="match-creation"><a class="header" href="#match-creation">Match Creation</a></h2>
<p>A new match can be created by anyone, by either using the command line client or
some other mean. When creating a match the user must specify the following parameters:</p>
<ul>
<li>game to be played</li>
<li>name of the match</li>
<li>number of players</li>
<li>number of server bots</li>
<li>timeout for player inactivity</li>
<li>an optional password to join the match</li>
<li>optionally the server password to create a verified game</li>
<li>other parameters specific to the game requested</li>
</ul>
<p>Note that, depending on the client used, some parameters could have defaults, and
as such will not be needed to be specified. Also note that, depending on the game
chosen, not all possible values of such parameters will be available (e.g. for
Rock Paper Scissors creating a match with a number of players rather than 2 will
cause an error and the match will not be created). Such restrictions will be
indicated on the description of each game.</p>
<p>A match starts as soon as the number of players needed to start it has been reached.
If a waiting-to-start match is inactive for some time, it will be removed from the
lobby. The command line client provides an indication of such expiration time.</p>
<p>When created, the server will return the match ID, which is the identifier needed
to join or spectate a match.</p>
<h2 id="spectators"><a class="header" href="#spectators">Spectators</a></h2>
<p><strong>Code Colosseum</strong> provides the ability to spectate any match, either be waiting
to start or already running. Spectators can spectate password protected matches
without needing a password. Thus, in the spectator sense, all matches are public.</p>
<p>Spectators will get a read-only stream of the match, the contents of which are
specified in the description of each game. Note that, like the stream for playing
parties, the stream is not supposed to be human-readable, and as such will likely
need to be connected to a program that renders it in a human-readable way.</p>
<p>Note that some games provide such rendering programs, some even with a graphical
user interface.</p>
<h1 id="command-line-client"><a class="header" href="#command-line-client">Command Line Client</a></h1>
<p><strong>Code Colosseum</strong> provdes <code>coco</code>, a command line client that provides an user
interface to interact with a <strong>Code Colosseum</strong> server.</p>
<h2 id="prebuilt-binaries"><a class="header" href="#prebuilt-binaries">Prebuilt binaries</a></h2>
<p>Prebuilt binaries for <code>coco</code> can be found in the <a href="https://github.com/dariost/CodeColosseum/releases/latest"><em>Releases</em></a> section of the
<a href="https://github.com/dariost/CodeColosseum/">GitHub page</a>.
It is advised to put the downloaded and extracted executable in a directory
included in the system <code>PATH</code>.</p>
<p>If a prebuilt binary for the desired operating system and architecture is not
found, then the only option is to build <code>coco</code> from the source code.</p>
<h2 id="building-from-source"><a class="header" href="#building-from-source">Building from source</a></h2>
<p>The command line client is written in the <a href="https://www.rust-lang.org/">Rust</a>
programming language. Thus, to build it the first step is to
<a href="https://www.rust-lang.org/tools/install">install Rust</a>.</p>
<p>Once the Rust compiler has been installed, the source code can be downloaded
<a href="https://github.com/dariost/CodeColosseum/releases/latest">here</a>. Alternatively,
it can be obtained by cloning the GitHub repository by using the following command:</p>
<pre><code class="language-shell">$ git clone https://github.com/dariost/CodeColosseum.git
</code></pre>
<p>Then, the client can be built using the following command:</p>
<pre><code class="language-shell">$ cargo build --release --bin coco
</code></pre>
<p>The resulting compiled binary file will be found in the <code>target/release/</code>
directory, and will be named <code>coco.exe</code> on Windows and <code>coco</code> on other operating
systems. It is advised to put such program in a directory included in the system
<code>PATH</code>.</p>
<h2 id="basic-usage"><a class="header" href="#basic-usage">Basic usage</a></h2>
<p><code>coco</code> provides several subcommands that will be discussed in the following
subsections. It is advised to read such subsections as well as using the <code>--help</code>
feature of <code>coco</code> to explore its options:</p>
<pre><code class="language-shell">$ coco --help
</code></pre>
<p>The only common option to all of <code>coco</code> subcommands is the server directive, used
to specify the server to which <code>coco</code> will connect and passed using the <code>-s</code> prefix.</p>
<p>The official server of <strong>Code Colosseum</strong> is located at <code>wss://code.colosseum.cf/</code>,
thus all examples will feature such server. As a first example, the invocation of
<code>coco</code> to list the available games on the official server would be:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ list
</code></pre>
<h1 id="list"><a class="header" href="#list">list</a></h1>
<p>This subcommand can be used to list the available games on a server:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ list
</code></pre>
<p>This will print a list of available games.</p>
<p>This subcommand can also be used to retrieve the description for a game. To do so
the game name must be specified after <code>list</code>. For instance, to get the description
for the game <code>roshambo</code> the following command can be used:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ list roshambo
</code></pre>
<p>Note that all descriptions should be written in MarkDown, thus, if <code>pandoc</code> is
available, a PDF can be generated from the description of a game using the following
command:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ list roshambo | pandoc -o roshambo.pdf
</code></pre>
<h1 id="lobby-1"><a class="header" href="#lobby-1">lobby</a></h1>
<p>This subcommand can be used to list waiting to start and running matches currently
present in the lobby:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ lobby
</code></pre>
<p>This will print a table with information about the matches:</p>
<ul>
<li><strong>ID</strong>: the unique identifier of the match;</li>
<li><strong>Verified</strong>: whether the game has been created by a server admin;</li>
<li><strong>Name</strong>: the name of the match;</li>
<li><strong>Game</strong>: the game to be played;</li>
<li><strong>Players</strong>: the number of currently connected players over the number of players needed to start the match;</li>
<li><strong>Spectators</strong>: the number of currently spectators connected to this match;</li>
<li><strong>Timeout</strong>: the timeout (in seconds) for players send some (valid) data before getting forcibly disconnected by the server;</li>
<li><strong>Password</strong>: whether a password is needed to join the match;</li>
<li><strong>Timing</strong>: expiration information for waiting to start matches and running time for running matches.</li>
</ul>
<h1 id="new"><a class="header" href="#new">new</a></h1>
<p>This subcommand can be used to create a new match. The bare minimum needed to
create a match is to provide the game to be played. For instance, creating a match
of <code>roshambo</code> can be done using the following command:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ new roshambo
</code></pre>
<p>If the creation is succesul the unique ID of the match will be printed, otherwise
an error message will be shown.</p>
<p>The creation of a new match can be further customised.</p>
<p>To add a custom name for the match you can add a positional argument at the end:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ new roshambo &quot;Test Match&quot;
</code></pre>
<p>To specify the number of players for the match, the <code>-n</code> switch can be used:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ new roshambo -n 2
</code></pre>
<p>To specify the number of server provided bots for the match, the <code>-b</code> switch can be used:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ new roshambo -b 1
</code></pre>
<p>To specify the timeout for player inactivity, the <code>-t</code> switch can be used:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ new roshambo -t 5
</code></pre>
<p>To specify a password to join the game, the <code>-p</code> switch can be used:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ new roshambo -p &quot;securepassword&quot;
</code></pre>
<p>To specify further arguments specific to the game, the <code>-a</code> switch can be used
(even multiple times), following the format <code>-a key=val</code>:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ new roshambo -a rounds=100
</code></pre>
<p>To create a verified game, if in posses of the server master password, the <code>-v</code> switch can be used:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ new roshambo -v &quot;servermasterpassword&quot;
</code></pre>
<h1 id="connect"><a class="header" href="#connect">connect</a></h1>
<p>This subcommand can be used to join a waiting-to-be-started match or spectate
any match (either already running or not). The bare minimum needed to join or
spectate a match is the match unique ID and a local program to run which will
be connected to the server data stream. The protocol of such stream is discussed
in the description of each game.</p>
<p>To then join a match with ID <code>abacaba</code> using the program <code>prog.exe</code> the command would be:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ connect &quot;abacaba&quot; -- prog.exe
</code></pre>
<p>And to spectate it the <code>-s</code> switch must be added:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ connect -s &quot;abacaba&quot; -- prog.exe
</code></pre>
<p>Note that it is possible to provide arguments to the local program, for instance:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ connect &quot;abacaba&quot; -- prog.exe arg1 arg2
</code></pre>
<p>This is useful when wanting to connect a program written in an interpreted language
such as python. For instance, to connect the program <code>prog.py</code> che command would be:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ connect &quot;abacaba&quot; -- python prog.py
</code></pre>
<p>Note that it is possible to omit the local program, however this is discouraged,
as it will cause a <code>cat</code>-like program to be called instead.</p>
<p>If a match is password protected, the password can be provided with the <code>-p</code> switch:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ connect -p &quot;securepassword&quot; &quot;abacaba&quot; -- prog.exe
</code></pre>
<p>When joining a match a custom username can be choosed by using the <code>-n</code> switch:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ connect -n &quot;verycoolname&quot; &quot;abacaba&quot; -- prog.exe
</code></pre>
<p>Note that both the username and password options are ignored when spectating.</p>
<p>The communication with the local program is performed through a channel. There are
two channels types available, <code>stdio</code> and <code>pipe</code>. The default is <code>stdio</code>. The channel
can be choosed using the <code>-c</code> switch:</p>
<pre><code class="language-shell">$ coco -s wss://code.colosseum.cf/ connect -c &quot;pipe&quot; &quot;abacaba&quot; -- prog.exe
</code></pre>
<p>The details of such channels are discussed in the further subsubsections.</p>
<h1 id="stdio-channel"><a class="header" href="#stdio-channel">stdio channel</a></h1>
<p>The <code>stdio</code> communication channel uses the program <code>stdout</code> for output and
<code>stdin</code> for input. This is the classically used communication method for
most of the contents management systems.</p>
<p>Thus, to read from the server data stream is to read from <code>stdin</code> and to write
to the server data stream is to write to <code>stdout</code>. Note that it is a good practice
to flush <code>stdout</code> after each write, since some buffering might happend and the
written command would not be sent to the server.</p>
<p>Since the <code>stdin</code> and <code>stdout</code> streams of the program are managed by <code>coco</code> to
communicate with the server, they cannot be used to read or write strings from or
to the terminal. However, the <code>stderr</code> stream is free, and can be used to write
strings to the terminal. If more freedom is needed, refer to the <code>pipe</code>
communication channel.</p>
<p>In spectator mode only the <code>stdin</code> stream is captured by <code>coco</code>.</p>
<p>A simple usage example in python of the <code>stdio</code> communication channel is provided:</p>
<pre><code class="language-python">#!/usr/bin/env python3

from sys import stderr

if __name__ == &quot;__main__&quot;:
    from_server = input().strip()
    print(&quot;to_server&quot;, flush=True)
    print(&quot;debug print&quot;, file=stderr)
</code></pre>
<h1 id="pipe-channel"><a class="header" href="#pipe-channel">pipe channel</a></h1>
<p>The <code>pipe</code> communication channel uses <a href="https://en.wikipedia.org/wiki/Named_pipe">named pipes</a>
as the communication mean to and from the program. Since the implementation of
named pipes is wildly different between Unix-like operating systems and Windows,
they shall be discussed separately.</p>
<h2 id="unix-like-linux-macos-freebsd-etc"><a class="header" href="#unix-like-linux-macos-freebsd-etc">Unix-like (Linux, macOS, FreeBSD, etc.)</a></h2>
<p>On Unix-like systems named pipes can be read and written as ordinary files. Thus,
their use is no different than reading and writing using the common libraries that
programming languages usually provide.</p>
<p>If a program is started by <code>coco</code> with the <code>pipe</code> channel, <code>coco</code> will pass to the
program two environment variables: <code>COCO_PIPEIN</code> and <code>COCO_PIPEOUT</code>. These
two variables contain the names of the files to be used for input and output,
respectively.</p>
<p>The program shall read the file names from these environment variables and open
the respective files in read and write mode as the first operation of the program.</p>
<p><strong><code>coco</code> will not consider the program as started until both files are opened.</strong></p>
<p>Since the program sees these pipes as files, writing operations to the output pipe
will be buffered even in the presence of a <code>LF</code>, since the rules for buffering are
different between files and <code>stdout</code>.
<strong>Thus, the output stream must be flushed manually when written.</strong></p>
<p>In spectator mode only <code>COCO_PIPEIN</code> is provided to the program.</p>
<p>A simple usage example in python of the <code>pipe</code> communication channel is provided:</p>
<pre><code class="language-python">#!/usr/bin/env python3

from os import environ

if __name__ == &quot;__main__&quot;:
    fin = open(environ[&quot;COCO_PIPEIN&quot;], &quot;r&quot;)
    fout = open(environ[&quot;COCO_PIPEOUT&quot;], &quot;w&quot;)
    from_server = fin.readline().strip()
    print(&quot;to_server&quot;, file=fout, flush=True)
    print(&quot;debug print&quot;)
</code></pre>
<h2 id="windows"><a class="header" href="#windows">Windows</a></h2>
<p>The <code>pipe</code> communication channel is currently unavailable on Windows.</p>
<h1 id="games"><a class="header" href="#games">Games</a></h1>
<p>The following subsections contain the descriptions of available games.</p>
<p>The standard format for a description contains:</p>
<ul>
<li>an introduction to the game;</li>
<li>an <em>Implementation details</em> subsection, containing the description of the communication protocol between the players programs and the server, as well as the one for spectators;</li>
<li>a <em>Game parameters</em> subsection, containing the game-specific parameters that can be passed on the creation of a match via the <code>-a</code> switch, if using the command line client.</li>
</ul>
<h1 id="roshambo-rock-paper-scissors"><a class="header" href="#roshambo-rock-paper-scissors">roshambo (Rock Paper Scissors)</a></h1>
<p><strong>Rock Paper Scissors</strong> (also called <em>roshambo</em>) is one of the most basic hand games.</p>
<p>It is played by two players, which in each round choose one of the gestures <em>paper</em>, <em>rock</em> or <em>scissors</em> and show them at the same time. If the two gestures chosen are different, the winner is computed as follows:</p>
<ul>
<li><em>paper</em> wins over <em>rock</em></li>
<li><em>rock</em> wins over <em>scissors</em></li>
<li><em>scissors</em> win over <em>paper</em></li>
</ul>
<p>For each round a point is awarded to the winner (if any). The player with most points at the end wins.</p>
<h2 id="implementation-details"><a class="header" href="#implementation-details">Implementation details</a></h2>
<p>Both players and the spectators will receive three lines at the beginning of the match, containing the two players names and the number of rounds. Each player will receive its own name as the first line.</p>
<p>For instance, if there are two players <code>Player0</code> and <code>Player1</code> in a match with <code>42</code> rounds, then:</p>
<p><code>Player0</code> will receive:</p>
<pre><code class="language-text">Player0
Player1
42
</code></pre>
<p><code>Player1</code> will receive:</p>
<pre><code class="language-text">Player1
Player0
42
</code></pre>
<p>Spectators will receive:</p>
<pre><code class="language-text">Player0
Player1
42
</code></pre>
<p>Then, for the number of rounds specified, both players will have to send their choice of move to the server using one of the strings <code>ROCK</code>, <code>PAPER</code> or <code>SCISSORS</code> with a single <code>LF</code> (aka <code>\n</code>) at the end. After sending a move choice, they will have to read a single line containing the choice of the opponent. Other then the opponent choice, the string <code>RETIRE</code> can also be received, which means the opponent as retired and the player must exit the match. This cycle will then repeat for the remaining rounds.</p>
<p>Spectators will receive for each round two lines containing the choice of the two players. The lines are given in the same order as players names at the beginning of the stream.</p>
<p>For instance, if in a round <code>Player0</code> chooses <code>ROCK</code> and <code>Player1</code> chooses <code>PAPER</code>, then (sent lines are prefixed with a <code>&gt;</code>):</p>
<p><code>Player0</code> will receive:</p>
<pre><code class="language-text">&gt;ROCK
PAPER
</code></pre>
<p><code>Player1</code> will receive:</p>
<pre><code class="language-text">&gt;PAPER
ROCK
</code></pre>
<p>Spectators will receive:</p>
<pre><code class="language-text">ROCK
PAPER
</code></pre>
<p>A complete game can look like this:</p>
<p><code>Player0</code> will receive:</p>
<pre><code class="language-text">Player0
Player1
3
&gt;ROCK
PAPER
&gt;PAPER
PAPER
&gt;ROCK
SCISSORS
</code></pre>
<p><code>Player1</code> will receive:</p>
<pre><code class="language-text">Player1
Player0
3
&gt;PAPER
ROCK
&gt;PAPER
PAPER
&gt;SCISSORS
ROCK
</code></pre>
<p>Spectators will receive:</p>
<pre><code class="language-text">Player0
Player1
3
ROCK
PAPER
PAPER
PAPER
ROCK
SCISSORS
</code></pre>
<h2 id="game-parameters"><a class="header" href="#game-parameters">Game parameters</a></h2>
<p>There are two game specific parameters available:</p>
<ul>
<li><code>rounds</code>: specifies the number of rounds;</li>
<li><code>pace</code>: specifies a minimum time interval (in seconds) between rounds.</li>
</ul>
<h1 id="royalur-royal-game-of-ur"><a class="header" href="#royalur-royal-game-of-ur">royalur (Royal Game of Ur)</a></h1>
<p>The Royal Game of Ur is one the oldest board games, dating back to at least 5000 years ago. <a href="https://www.youtube.com/watch?v=WZskjLq040I">This excellent video</a> gives a thorough introduction to this game, explaining its rules from <a href="https://www.youtube.com/watch?v=WZskjLq040I&amp;t=221s">3:41</a> to 5:10.</p>
<svg width="196.5mm" height="74.001mm" version="1.1" viewBox="0 0 196.5 74.001" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<metadata>
<rdf:RDF>
<cc:Work rdf:about="">
<dc:format>image/svg+xml</dc:format>
<dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
<dc:title/>
</cc:Work>
</rdf:RDF>
</metadata>
<g>
<rect x=".25011" y=".25012" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="24.75" y=".25012" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="49.25" y=".25012" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="73.75" y=".25012" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x=".25011" y="24.75" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="24.75" y="24.75" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="49.25" y="24.75" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="73.75" y="24.75" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x=".25012" y="49.25" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="24.75" y="49.25" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="49.25" y="49.25" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="73.75" y="49.25" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="98.251" y="24.75" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="122.75" y="24.75" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="147.25" y="24.75" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="171.75" y="24.75" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="147.25" y=".25011" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="171.75" y=".25011" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="147.25" y="49.25" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<rect x="171.75" y="49.25" width="24.5" height="24.5" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-miterlimit="10" stroke-width=".50022"/>
<path d="m73.75 24.75 24.5 24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<path d="m73.75 49.25 24.5-24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<ellipse cx="86" cy="37" rx="4.7478" ry="4.7478" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".50445"/>
<circle cx="86" cy="37" r="7.2505" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49904"/>
<circle cx="86" cy="37" r="9.7502" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49959"/>
<path d="m0.25011 0.25012 24.5 24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<path d="m0.25012 24.75 24.5-24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<ellipse cx="12.5" cy="12.5" rx="4.7478" ry="4.7478" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".50445"/>
<circle cx="12.5" cy="12.5" r="7.2505" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49904"/>
<circle cx="12.5" cy="12.5" r="9.7502" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49959"/>
<path d="m0.25012 49.25 24.5 24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<path d="m0.25013 73.75 24.5-24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<ellipse cx="12.5" cy="61.5" rx="4.7478" ry="4.7478" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".50445"/>
<circle cx="12.5" cy="61.5" r="7.2505" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49904"/>
<circle cx="12.5" cy="61.5" r="9.7502" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49959"/>
<path d="m147.25 0.25011 24.5 24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<path d="m147.25 24.75 24.5-24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<ellipse cx="159.5" cy="12.5" rx="4.7478" ry="4.7478" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".50445"/>
<circle cx="159.5" cy="12.5" r="7.2505" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49904"/>
<circle cx="159.5" cy="12.5" r="9.7502" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49959"/>
<path d="m147.25 49.25 24.5 24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<path d="m147.25 73.75 24.5-24.5" fill="none" stroke="currentColor" stroke-width=".50022"/>
<ellipse cx="159.5" cy="61.5" rx="4.7478" ry="4.7478" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".50445"/>
<circle cx="159.5" cy="61.5" r="7.2505" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49904"/>
<circle cx="159.5" cy="61.5" r="9.7502" fill="none" stroke="currentColor" stroke-dashoffset="94.488" stroke-width=".49959"/>
<path d="m110.77 12.223h-97.976v19.492h170.83v-19.252h-41.645" fill="none" stroke="#ff3f00"/>
<path d="m111.55 61.244h-98.937v-18.952h171.17v19.035h-40.957" fill="none" stroke="#00ff7f"/>
<path d="m139 12.462 4.505-2.6009v2.6009 2.6009l-2.2525-1.3005z" fill="#ff3f00" stroke="#ff3f00" stroke-dashoffset="94.488"/>
<path d="m139 61.327 4.505-2.6009v2.6009 2.6009l-2.2525-1.3005z" fill="#00ff7f" stroke="#00ff7f" stroke-dashoffset="94.488"/>
</g>
</svg>
<p>The Royal Game of Ur is a race game. Each player has 7 tokens, and it wants to send all tokens to the end of the track before the opponent does. Each player has a track of 14 cells (not counting start and end), with the cells from the fifth to the twelfth (included) shared between players. The game is played in turns alternating between the two players until one of them make all of their tokens exit the track, winning the game.</p>
<p>At the start of its turn, the player flips 4 two-sided coins, which will give a number \( n \) of heads. The player must then choose a token to move \( n \) cells forward. For a token, to exit the track, the exact number of cells remaining is needed (e.g. if a token is on the fourteenth cell, only a \( 1 \) can make it exit the track). If no moves are possible for the player (such as when getting a \( 0 \), but it's not the only such case) then it skips the turn, giving it to the other player.</p>
<p>The player cannot move a token in a cell already occupied by one of its token, however it can move it in a cell occupied by an opponent's token. In this case, the opponent's token gets instantly sent back to the opponent's track start, and the cell becomes occupied by the player token.</p>
<p>If a token lands on the fourth, eighth or fourteenth cell, the player gets to play also for the next turn, otherwise the opponent's turn begins. A token cannot land on one of these 3 cells if it's already occupied (even by an opponent's token).</p>
<h2 id="implementation-details-1"><a class="header" href="#implementation-details-1">Implementation details</a></h2>
<p>At the beginning of the game both players will receive 3 lines:</p>
<ul>
<li>the first line contains the name of the first player;</li>
<li>the second line contains the name of the second player;</li>
<li>the third line contains <code>0</code> if the receiver is the first player, <code>1</code> otherwise.</li>
</ul>
<p>Spectators will only receive the first two lines. In the first turn the first player will play.</p>
<p>Each turn is subdivided into two sub-turns:</p>
<ul>
<li><code>roll</code>;</li>
<li><code>move</code>.</li>
</ul>
<p>In the <code>roll</code> sub-turn both players and spectators will receive a single line containing 4 space-separated binary digits. The <code>1</code>s represent a head, the <code>0</code> a tail. The amount \( n \) is calculated as the number of <code>1</code>s obtained.</p>
<p>If the player has no valid moves that move a token \( n \) cells forward, the the <code>move</code> sub-turn is skipped and the <code>roll</code> sub-turn immediately starts for the other player.</p>
<p>Otherwise, the <code>move</code> sub-turn begins. Each player has <code>7</code> tokens, numbered from <code>0</code> to <code>6</code> (inclusive). The player playing in this turn must write a single line with the number of the token he wants to move forward \( n \) cells, ended with a <code>LF</code> (aka <code>\n</code>). The move must be valid. If the move is valid, the other player and the spectators will receive the sent number, otherwise they will receive <code>RETIRE</code>, which indicates that the game has ended with a win for the opponent.</p>
<p>If the token lands on the fourth, eighth or fourteenth cell than the player has another turn, thus moving again to the <code>roll</code> sub-turn. Otherwise, the turns pass to the opponent, which begins its <code>roll</code> turn.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<p>This is an example of the streams of two players, <code>PlayerA</code> and <code>PlayerB</code>, and the spectators for an hypothetical game.</p>
<p>Note that all lines prepended with a <code>&gt;</code> indicate that the line is sent rather than received.</p>
<p>Stream of <code>PlayerA</code>:</p>
<pre><code class="language-text">PlayerA
PlayerB
0
0 0 1 1
&gt;3
1 1 1 1
0
1 0 1 0
0
0 1 0 0
&gt;3
0 0 0 0
1 0 1 1
&gt;3
0 0 1 1
0
0 0 0 1
&gt;4
1 0 1 0
RETIRE
</code></pre>
<p>Stream of <code>PlayerB</code>:</p>
<pre><code class="language-text">PlayerA
PlayerB
1
0 0 1 1
3
1 1 1 1
&gt;0
1 0 1 0
&gt;0
0 1 0 0
3
0 0 0 0
1 0 1 1
3
0 0 1 1
&gt;0
0 0 0 1
4
1 0 1 0
&gt;2
</code></pre>
<p>Stream of spectators:</p>
<pre><code class="language-text">PlayerA
PlayerB
0 0 1 1
3
1 1 1 1
0
1 0 1 0
0
0 1 0 0
3
0 0 0 0
1 0 1 1
3
0 0 1 1
0
0 0 0 1
4
1 0 1 0
RETIRE
</code></pre>
<h2 id="game-parameters-1"><a class="header" href="#game-parameters-1">Game parameters</a></h2>
<p>There's only one game-specific parameter:</p>
<ul>
<li><code>pace</code>: the minimum number of seconds between turns (default: <code>1.5</code>, min: <code>0</code>, max: <code>30</code>).</li>
</ul>
<p>Additional information:</p>
<ul>
<li>the game can only be played by exactly <code>2</code> players;</li>
<li>the default timeout is <code>90</code> seconds;</li>
<li>no more than <code>1</code> server bot per game is allowed.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
        
        

    </body>
</html>
